/services (or /integrations) – for integrating with external APIs and implementing business logic:
aiService – logic to communicate with the AI language model. This could call OpenAI’s API (GPT-4) or a local model. It will likely have methods like generateChatCompletion(conversationContext). If using OpenAI, it will format the messages into their API format and handle the streaming of responses. If using an open model, it might send a request to a Python service. We could also incorporate LangChain or similar libraries to manage context or tools
tripleminds.co
, but initially we can handle context manually by truncating or summarizing old messages when they exceed the window. For NSFW, we ensure this service does minimal filtering – maybe just catches truly disallowed content.
imageService – integration with the image generation AI (e.g., calls StabilityAI or Replicate). It will take in parameters or a prompt and call the API, handling the response (image URL or binary). If images are generated on our own server (with Python), this service would forward the request to that process. We also ensure this respects the NSFW nature (no additional filter aside from what the model can/can’t do).
voiceService – integration with a text-to-speech API (like Google Cloud TTS or Eleven Labs) for generating voice audio from text. It would accept text and a voice settings (possibly each character has a voice ID or style) and return an audio file URL or stream. For user speech-to-text (if implemented), we might have a speechToTextService using something like Google STT or Whisper.
paymentService – wraps Stripe SDK calls. For instance, creating a Checkout Session, validating webhook signatures, retrieving product/price info. Also handles upgrading the user in the database when payment succeeds.
authService – if needed, to abstract Clerk/Passport logic. Possibly not needed if using Passport strategies directly in routes or Clerk middleware. But if implementing our own OAuth, this would contain logic to verify Google tokens, etc.
moderationService (optional) – could use a third-party or simple keyword check to prevent disallowed content (like ensure no mention of underage characters in public content, etc.). Not heavily advertised by GF but prudent to include.